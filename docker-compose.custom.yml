# Config override for deployment
version: '3'

volumes:
  wom_registry_database_dev:
    external: true
  wom_registry_mongodb_dev:
    external: true

services:
  api:
    environment:
    - ASPNETCORE_ENVIRONMENT=Development
    volumes:
    - ./testkeys:/testkeys:ro
    labels:
    - "traefik.enable=true"
    - "traefik.docker.network=web"
    - "traefik.protocol=http"
    - "traefik.port=8779"
    - "traefik.frontend.rule=Host:dev.wom.social"
    - "traefik.frontend.entryPoints=http,https"

  database:
    volumes:
    - wom_registry_database_dev:/var/lib/mysql:rw

  database-manager:
    environment:
    - "PMA_ABSOLUTE_URI=https://dev.wom.social/phpmyadmin/"
    labels:
    - "traefik.enable=true"
    - "traefik.docker.network=web"
    - "traefik.protocol=http"
    - "traefik.port=80"
    - "traefik.frontend.rule=Host:dev.wom.social;PathPrefixStrip:/phpmyadmin"
    - "traefik.frontend.entryPoints=https"

  mongo:
    volumes:
    - wom_registry_mongodb_dev:/data/db:rw
    ports:
    - "8123:27017"
